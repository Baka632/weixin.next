<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link onerror="wx_loaderror(this)" onerror="wx_loaderror(this)" rel="stylesheet" type="text/css" href="https://res.wx.qq.com/mpres/htmledition/style/page/resource/res_iframe2f613f.css"/> 
</head>
<body class="page_doc">
    <div class="main_hd"><h2>获取用户基本信息(UnionID机制)</h2>
</div>
    <div class="main_bd"> 
        <div class="article_box">
            <div class="inner">
                <div class="news_content">
                    <p><span style="font-size: 14px; font-family: 微软雅黑, 'Microsoft YaHei';"></span>在关注者与公众号产生消息交互后，公众号可获得关注者的OpenID（加密后的微信号，每个用户对每个公众号的OpenID是唯一的。对于不同公众号，同一用户的openid不同）。公众号可通过本接口来根据OpenID获取用户基本信息，包括昵称、头像、性别、所在城市、语言和关注时间。</p>
<p>请注意，如果开发者有在多个公众号，或在公众号、移动应用之间统一用户帐号的需求，需要前往微信开放平台（open.weixin.qq.com）绑定公众号后，才可利用UnionID机制来满足上述需求。</p>
<p>UnionID机制说明：</p>
<p>开发者可通过OpenID来获取用户基本信息。特别需要注意的是，如果开发者拥有多个移动应用、网站应用和公众帐号，可通过获取用户基本信息中的unionid来区分用户的唯一性，因为只要是同一个微信开放平台帐号下的移动应用、网站应用和公众帐号，用户的unionid是唯一的。换句话说，同一用户，对同一个微信开放平台下的不同应用，unionid是相同的。&nbsp;</p>
<p><strong>获取用户基本信息（包括UnionID机制）</strong></p>
<p>开发者可通过OpenID来获取用户基本信息。请使用https协议。</p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);"><p>接口调用请求说明</p>
<p>http请求方式: GET https://api.weixin.qq.com/cgi-bin/user/info?access_token=ACCESS_TOKEN&amp;openid=OPENID&amp;lang=zh_CN <br></p>
</div><p>参数说明</p>
<table class="table" width="951"><tbody class="tbody"><tr class="firstRow thead"><td class="table_cell" width="217" valign="top" style="word-break: break-all;">参数</td><td class="table_cell" width="217" valign="top" style="word-break: break-all;">是否必须</td><td class="table_cell" width="217" valign="top" style="word-break: break-all;">说明</td></tr>
<tr><td class="table_cell" width="217">access_token</td><td class="table_cell" width="217">是</td><td class="table_cell" width="217">调用接口凭证</td></tr>
<tr><td class="table_cell" width="217">openid</td><td class="table_cell" width="217">是</td><td class="table_cell" width="217">普通用户的标识，对当前公众号唯一</td></tr>
<tr><td class="table_cell" width="217">lang</td><td class="table_cell" width="217">否</td><td class="table_cell" width="217">返回国家地区语言版本，zh_CN 简体，zh_TW 繁体，en 英语</td></tr>
</tbody></table>
<p>返回说明</p>
<p>正常情况下，微信会返回下述JSON数据包给公众号：</p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);">{<br> &nbsp; &nbsp;"subscribe": 1, <br> &nbsp; &nbsp;"openid": "o6_bmjrPTlm6_2sgVt7hMZOPfL2M", <br> &nbsp; &nbsp;"nickname": "Band", <br> &nbsp; &nbsp;"sex": 1, <br> &nbsp; &nbsp;"language": "zh_CN", <br> &nbsp; &nbsp;"city": "广州", <br> &nbsp; &nbsp;"province": "广东", <br> &nbsp; &nbsp;"country": "中国", <br><p>&nbsp; &nbsp;"headimgurl": &nbsp;"http://wx.qlogo.cn/mmopen/g3MonUZtNHkdmzicIlibx6iaFqAc56vxLSUfpb6n5WKSYVY0ChQKkiaJSgQ1dZuTOgvLLrhJbERQQ4</p>
<p>eMsv84eavHiaiceqxibJxCfHe/0",</p>&nbsp; "subscribe_time": 1382694957,<br> &nbsp; "unionid": " o6_bmasdasdsad6_2sgVt7hMZOPfL"<br> &nbsp; "remark": "",<br><p>&nbsp; "groupid": 0,</p>
<p>&nbsp; "tagid_list":[128,2]</p>}</div>
<p>参数说明</p>
<table class="table" width="951"><tbody class="tbody"><tr class="firstRow thead"><td class="table_cell" width="325" valign="top" style="word-break: break-all;">参数</td><td class="table_cell" width="325" valign="top" style="word-break: break-all;">说明</td></tr>
<tr><td class="table_cell" width="325">subscribe</td><td class="table_cell" width="325">用户是否订阅该公众号标识，值为0时，代表此用户没有关注该公众号，拉取不到其余信息。</td></tr>
<tr><td class="table_cell" width="325">openid</td><td class="table_cell" width="325">用户的标识，对当前公众号唯一</td></tr>
<tr><td class="table_cell" width="325">nickname</td><td class="table_cell" width="325">用户的昵称</td></tr>
<tr><td class="table_cell" width="325">sex</td><td class="table_cell" width="325">用户的性别，值为1时是男性，值为2时是女性，值为0时是未知</td></tr>
<tr><td class="table_cell" width="325">city</td><td class="table_cell" width="325">用户所在城市</td></tr>
<tr><td class="table_cell" width="325">country</td><td class="table_cell" width="325">用户所在国家</td></tr>
<tr><td class="table_cell" width="325">province</td><td class="table_cell" width="325">用户所在省份</td></tr>
<tr><td class="table_cell" width="325">language</td><td class="table_cell" width="325">用户的语言，简体中文为zh_CN</td></tr>
<tr><td class="table_cell" width="325">headimgurl</td><td class="table_cell" width="325">用户头像，最后一个数值代表正方形头像大小（有0、46、64、96、132数值可选，0代表640*640正方形头像），用户没有头像时该项为空。若用户更换头像，原有头像URL将失效。</td></tr>
<tr><td class="table_cell" width="325">subscribe_time</td><td class="table_cell" width="325">用户关注时间，为时间戳。如果用户曾多次关注，则取最后关注时间</td></tr>
<tr><td class="table_cell" width="325">unionid</td><td class="table_cell" style="word-break: break-all;" width="325">只有在用户将公众号绑定到微信开放平台帐号后，才会出现该字段。</td></tr>
<tr><td class="table_cell" width="325">remark</td><td class="table_cell" width="325">公众号运营者对粉丝的备注，公众号运营者可在微信公众平台用户管理界面对粉丝添加备注</td></tr>
<tr><td class="table_cell" colspan="1" rowspan="1">groupid</td><td class="table_cell" colspan="1" rowspan="1">用户所在的分组ID（兼容旧的用户分组接口）</td></tr>
<tr><td class="table_cell" width="325">tagid_list</td><td class="table_cell" width="325">用户被打上的标签ID列表</td></tr>
</tbody></table>
<p>错误时微信会返回错误码等信息，JSON数据包示例如下（该示例为AppID无效错误）:</p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);">{"errcode":40013,"errmsg":"invalid appid"}</div>
<p><strong>批量获取用户基本信息</strong><br></p>
<p>开发者可通过该接口来批量获取用户基本信息。最多支持一次拉取100条。</p>
<p>接口调用请求说明</p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);"><p>http请求方式: POST</p>
<p>https://api.weixin.qq.com/cgi-bin/user/info/batchget?access_token=ACCESS_TOKEN</p>
</div><p>POST数据示例</p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);">{<br> &nbsp; &nbsp;"user_list": [<br> &nbsp; &nbsp; &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"openid": "otvxTs4dckWG7imySrJd6jSi0CWE", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"lang": "zh-CN"<br> &nbsp; &nbsp; &nbsp; &nbsp;}, <br> &nbsp; &nbsp; &nbsp; &nbsp;{<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"openid": "otvxTs_JZ6SEiP0imdhpi50fuSZg", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;"lang": "zh-CN"<br> &nbsp; &nbsp; &nbsp; &nbsp;}<br> &nbsp; &nbsp;]<br>}</div>
<p>参数说明<br></p>
<table class="table" width="951"><tbody class="tbody"><tr class="firstRow thead"><td class="table_cell" width="217" valign="top" style="word-break: break-all;">参数</td><td class="table_cell" width="217" valign="top" style="word-break: break-all;">是否必须</td><td class="table_cell" width="217" valign="top" style="word-break: break-all;">说明</td></tr>
<tr><td class="table_cell" width="217">openid</td><td class="table_cell" width="217">是</td><td class="table_cell" width="217">用户的标识，对当前公众号唯一</td></tr>
<tr><td class="table_cell" width="217">lang</td><td class="table_cell" width="217">否</td><td class="table_cell" width="217">国家地区语言版本，zh_CN 简体，zh_TW 繁体，en 英语，默认为zh-CN</td></tr>
</tbody></table>
<p>返回说明</p>
<p>正常情况下，微信会返回下述JSON数据包给公众号（示例中为一次性拉取了2个openid的用户基本信息，第一个是已关注的，第二个是未关注的）：</p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);">{<br> &nbsp; "user_info_list": [<br> &nbsp; &nbsp; &nbsp; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "subscribe": 1, <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "openid": "otvxTs4dckWG7imySrJd6jSi0CWE", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "nickname": "iWithery", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "sex": 1, <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "language": "zh_CN", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "city": "Jieyang", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "province": "Guangdong", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "country": "China", <br><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "headimgurl": "http://wx.qlogo.cn/mmopen/xbIQx1GRqdvyqkMMhEaGOX802l1CyqMJNgUzKP8MeAeHFicRDSnZH7FY4XB7p8XHXIf6uJA2SCun</p>
<p>TPicGKezDC4saKISzRj3nz/0",</p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "subscribe_time": 1434093047, <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "unionid": "oR5GjjgEhCMJFyzaVZdrxZ2zRRF4", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "remark": "", <br><p>&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "groupid": 0,</p>
<p>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "tagid_list":[128,2]<br></p>&nbsp; &nbsp; &nbsp; }, <br> &nbsp; &nbsp; &nbsp; {<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "subscribe": 0, <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "openid": "otvxTs_JZ6SEiP0imdhpi50fuSZg", <br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; "unionid": "oR5GjjjrbqBZbrnPwwmSxFukE41U", <br> &nbsp; &nbsp; &nbsp; }<br> &nbsp; ]<br>}</div>
<p>参数说明<br></p>
<table class="table" width="951"><tbody class="tbody"><tr class="firstRow thead"><td class="table_cell" width="325" valign="top" style="word-break: break-all;">参数</td><td class="table_cell" width="325" valign="top" style="word-break: break-all;">说明</td></tr>
<tr><td class="table_cell" width="325">subscribe</td><td class="table_cell" width="325">用户是否订阅该公众号标识，值为0时，代表此用户没有关注该公众号，拉取不到其余信息，只有openid和UnionID（在该公众号绑定到了微信开放平台账号时才有）。</td></tr>
<tr><td class="table_cell" width="325">openid</td><td class="table_cell" width="325">用户的标识，对当前公众号唯一</td></tr>
<tr><td class="table_cell" width="325">nickname</td><td class="table_cell" width="325">用户的昵称</td></tr>
<tr><td class="table_cell" width="325">sex</td><td class="table_cell" width="325">用户的性别，值为1时是男性，值为2时是女性，值为0时是未知</td></tr>
<tr><td class="table_cell" width="325">city</td><td class="table_cell" width="325">用户所在城市</td></tr>
<tr><td class="table_cell" width="325">country</td><td class="table_cell" width="325">用户所在国家</td></tr>
<tr><td class="table_cell" width="325">province</td><td class="table_cell" width="325">用户所在省份</td></tr>
<tr><td class="table_cell" width="325">language</td><td class="table_cell" width="325">用户的语言，简体中文为zh_CN</td></tr>
<tr><td class="table_cell" width="325">headimgurl</td><td class="table_cell" width="325">用户头像，最后一个数值代表正方形头像大小（有0、46、64、96、132数值可选，0代表640*640正方形头像），用户没有头像时该项为空。若用户更换头像，原有头像URL将失效。</td></tr>
<tr><td class="table_cell" width="325">subscribe_time</td><td class="table_cell" width="325">用户关注时间，为时间戳。如果用户曾多次关注，则取最后关注时间</td></tr>
<tr><td class="table_cell" width="325">unionid</td><td class="table_cell" width="325">只有在用户将公众号绑定到微信开放平台帐号后，才会出现该字段。</td></tr>
<tr><td class="table_cell" width="325">remark</td><td class="table_cell" width="325">公众号运营者对粉丝的备注，公众号运营者可在微信公众平台用户管理界面对粉丝添加备注</td></tr>
<tr><td class="table_cell" colspan="1" rowspan="1">groupid<br></td><td class="table_cell" colspan="1" rowspan="1">用户所在的分组ID（暂时兼容用户分组旧接口）</td></tr>
<tr><td class="table_cell" width="325">tagid_list</td><td class="table_cell" width="325">用户被打上的标签ID列表</td></tr>
</tbody></table>
<p>错误时微信会返回错误码等信息，JSON数据包示例如下（该示例为AppID无效错误）:<br></p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);">{"errcode":40013,"errmsg":"invalid appid"}</div>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
<p><br></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>