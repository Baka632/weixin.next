
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link onerror="wx_loaderror(this)" onerror="wx_loaderror(this)" rel="stylesheet" type="text/css" href="https://res.wx.qq.com/mpres/htmledition/style/page/resource/res_iframe2f613f.css"/></head>
<body class="page_doc">
<div class="main_hd"><h2>摇一摇事件通知</h2>
</div>
<div class="main_bd">
<div class="article_box">
<div class="inner">
<div class="news_content">
<p><span><strong>接口说明</strong>&nbsp;</span></p>
<p><span>用户进入摇一摇界面，在“周边”页卡下摇一摇时，微信会把这个事件推送到开发者填写的URL（登录公众平台进入开发者中心设置）。推送内容包含摇一摇时“周边”页卡展示出来的页面所对应的设备信息，以及附近最多五个属于该公众账号的设备的信息。 当摇出列表时，此事件不推送。</span></p>
<p><span>微信服务器在五秒内收不到响应会断掉连接，并且重新发起请求，总共重试三次。关于重试的消息排重，推荐使用FromUserName + CreateTime 排重。假如服务器无法保证在五秒内处理并回复，可以直接回复空串，微信服务器不会对此作任何处理，并且不会发起重试。</span></p>
<p><span><strong>推送XML数据包示例</strong></span></p>
<div data-tag="backcolor"><span>&lt;xml&gt;<br>&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;<br>&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;<br>&lt;CreateTime&gt;1433332012&lt;/CreateTime&gt;<br> &nbsp; &nbsp;&lt;MsgType&gt;&lt;![CDATA[event]]&gt;&lt;/MsgType&gt;<br> &nbsp; &nbsp;&lt;Event&gt;&lt;![CDATA[ShakearoundUserShake]]&gt;&lt;/Event&gt;<br> &nbsp; &nbsp;&lt;ChosenBeacon&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Uuid&gt;&lt;![CDATA[uuid]]&gt;&lt;/Uuid&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Major&gt;major&lt;/Major&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Minor&gt;minor&lt;/Minor&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;Distance&gt;0.057&lt;/Distance&gt;<br> &nbsp; &nbsp;&lt;/ChosenBeacon&gt;<br> &nbsp; &nbsp;&lt;AroundBeacons&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;AroundBeacon&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Uuid&gt;&lt;![CDATA[uuid]]&gt;&lt;/Uuid&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Major&gt;major&lt;/Major&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Minor&gt;minor&lt;/Minor&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Distance&gt;166.816&lt;/Distance&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/AroundBeacon&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;AroundBeacon&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Uuid&gt;&lt;![CDATA[uuid]]&gt;&lt;/Uuid&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Major&gt;major&lt;/Major&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Minor&gt;minor&lt;/Minor&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;Distance&gt;15.013&lt;/Distance&gt;<br> &nbsp; &nbsp; &nbsp; &nbsp;&lt;/AroundBeacon&gt;<br> &nbsp; &nbsp;&lt;/AroundBeacons&gt;<br>&lt;/xml&gt;</span></div>
<p><span><strong>参数说明</strong></span></p>
<table class="table" width="951">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="325" valign="top"><span>参数</span></td><td class="table_cell" width="325" valign="top"><span>说明</span></td></tr>
<tr><td class="table_cell" width="325"><span>ToUserName</span></td><td class="table_cell" width="325"><span>开发者微信号</span></td></tr>
<tr><td class="table_cell" width="325"><span>FromUserName</span></td><td class="table_cell" width="325"><span>摇一摇用户（一个OpenID）</span></td></tr>
<tr><td class="table_cell" width="325"><span>CreateTime</span></td><td class="table_cell" width="325"><span>消息创建时间 （整型）</span></td></tr>
<tr><td class="table_cell" width="325"><span>MsgType</span></td><td class="table_cell" width="325"><span>消息类型，event</span></td></tr>
<tr><td class="table_cell" width="325"><span>Event</span></td><td class="table_cell" width="325"><span>事件类型，ShakearoundUserShake</span></td></tr>
<tr><td class="table_cell" width="325"><span>UUID、major、minor</span></td><td class="table_cell" width="325"><span>UUID、major、minor</span></td></tr>
<tr><td class="table_cell" width="325"><span>Distance</span></td><td class="table_cell" width="325"><span>设备与用户的距离（浮点数；单位：米）</span></td></tr>
</tbody>
</table>
<p><span>&nbsp;&nbsp;
<br></span></p>
</div>
</div>
</div>
</div>
</body>
</html>