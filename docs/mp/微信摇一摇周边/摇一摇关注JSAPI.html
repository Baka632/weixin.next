
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link onerror="wx_loaderror(this)" onerror="wx_loaderror(this)" rel="stylesheet" type="text/css" href="https://res.wx.qq.com/mpres/htmledition/style/page/resource/res_iframe2f613f.css"/></head>
<body class="page_doc">
<div class="main_hd"><h2>摇一摇关注JSAPI</h2>
</div>
<div class="main_bd">
<div class="article_box">
<div class="inner">
<div class="news_content">
<p><span></span></p>
<p><span><strong>接口说明</strong></span></p>
<p><span>摇一摇关注JS API目的是为已开通微信摇一摇周边，且有一定开发能力的商户提供摇一摇关注能力。商户可以在摇出来的页面直接调用摇一摇关注接口，实现关注公众账号的功能。</span></p>
<p><span>注意事项：</span></p>
<p><span>1)</span><span>&nbsp;&nbsp;&nbsp;&nbsp; </span><span>使用摇一摇关注时，不可诱导用户关注，一经查实，封号处罚；</span></p>
<p><span>2)</span><span>&nbsp;&nbsp;&nbsp;&nbsp; </span><span>摇一摇关注仅在摇一摇·周边出来的H5页面才能正常运行。直接在微信浏览器中打开网页，此接口无法运行。开发人员调试的时候注意，必须走完整的摇周边流程，通过摇一摇进入页面测试。</span></p>
<p><span>3)</span><span>&nbsp;&nbsp;&nbsp;&nbsp; </span><span>关注门店归属的公众账号，只支持在门店1公里范围内生效。</span></p>
<p><strong>数据示例</strong>
<br></p>
<p><span>关注JS API调用与微信的JS API调用格式一致，如下：</span></p>
<table class="table" width="951">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="325" valign="top"><span>公用函数</span></td><td class="table_cell" width="325" valign="top"><span>invoke</span></td></tr>
<tr><td class="table_cell" valign="top" colspan="1" rowspan="1" width="325"><span>用途</span></td><td class="table_cell" valign="top" colspan="1" rowspan="1" width="325"><span>主动调用指定API</span></td></tr>
<tr><td class="table_cell" width="325" valign="top"><span>通用形式</span></td><td class="table_cell" width="325" valign="top"><span>BeaconAddContactJsBridge.invoke("API名称", {调用参数}, &lt;回调函数&gt;); &nbsp; &nbsp;</span></td></tr>
</tbody>
</table>
<p><span>注意：文档中所有代码只能在微信摇周边的场景下才能正确运行。直接在微信浏览器中打开网页，BeaconAddContactJsBridge不会正确运行。开发人员调试的时候注意，必须走完整的摇周边流程，通过摇一摇进入页面测试。 
<br></span></p>
<p><span><strong>例子：</strong></span></p>
<div data-tag="backcolor">
<p><span></span></p>
<p><span><span>&lt;!</span><span>DOCTYPE</span><span>html&gt;</span></span></p>
<p><span><span>&lt;</span><span>html</span><span>lang</span><span>=</span><em><span>"en"</span></em><span>&gt;</span></span></p>
<p><span><span>&lt;</span><span>head</span><span>&gt;</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&lt;</span><span>meta</span><span>charset</span><span>=</span><em><span>"UTF-8"</span></em><span>&gt;</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&lt;</span><span>title</span><span>&gt;</span><span>开发者调用关注JS的example</span><span>&lt;/</span><span>title</span><span>&gt;</span></span></p>
<p><span><span>&lt;/</span><span>head</span><span>&gt;</span></span></p>
<p><span><span>&lt;</span><span>body</span><span>&gt;</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>&lt;</span><span>h1</span><span>&gt;</span><span>test</span><span>&lt;/</span><span>h1</span><span>&gt;</span></span></p>
<p><span><span>&lt;</span><span>script</span><span>type</span><span>=</span><em><span>"text/javascript"</span></em><span>src</span><span>=</span><em><span>"http://zb.weixin.qq.com/nearbycgi/addcontact/BeaconAddContactJsBridge.js"</span></em><span>&gt;</span></span></p>
<p><span><span>&lt;/</span><span>script</span><span>&gt;</span></span></p>
<p><span><span>&lt;</span><span>script</span><span>type</span><span>=</span><em><span>"text/javascript"</span></em><span>&gt;</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BeaconAddContactJsBridge.ready(</span><strong><span>function</span></strong><span>(){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>//判断是否关注</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BeaconAddContactJsBridge.invoke(</span><span>'checkAddContactStatus'</span><span>,{ type:0} ,</span><strong><span>function</span></strong><span>(apiResult){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span>if</span></strong><span>(apiResult.err_code == 0){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span>var</span></strong><span> status = apiResult.data;</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span>if</span></strong><span>(status == 1){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(</span><span>'已关注'</span><span>);</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span>else</span></strong><span>{</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(</span><span>'未关注'</span><span>);</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span>//跳转到关注页</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; BeaconAddContactJsBridge.invoke(</span><span>'jumpAddContact'</span><span>,{ type:0});</span></span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span>else</span></strong><span>{</span></span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(apiResult.err_msg)</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></p>
<p><span>&nbsp;</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></p>
<p><span><span>&lt;/</span><span>script</span><span>&gt;</span></span></p>
<p><span><span>&lt;/</span><span>body</span><span>&gt;</span></span></p>
<p><span><span>&lt;/</span><span>html</span><span>&gt;</span></span></p>
</div>
<p>
<br><span><strong>引入BeaconAddContactJsBridge</strong></span></p>
<div data-tag="backcolor">
<p><span></span></p>
<p><span><span>&lt;</span><span>script</span><span>type</span><span>=</span><em><span>"text/javascript"</span></em><span>src</span><span>=</span><em><span>"http://zb.weixin.qq.com/nearbycgi/addcontact/BeaconAddContactJsBridge.js"</span></em><span>&gt;</span></span></p>
<p><span><span>&lt;/</span><span>script</span><span>&gt;</span></span></p>
<p><span></span></p>
</div>
<p><span><strong>API详细说明</strong></span></p>
<p><strong><span>(一)判断是否关注checkAddContactStatus</span></strong></p>
<p><span>a)</span><span>&nbsp;&nbsp;&nbsp;&nbsp;</span><span>参数：传入{type:0}表示关注设备归属的公众账号，传入{ type:1}表示关注门店归属的公众账号。传入{ }默认为传入{type:0}。</span></p>
<p><span>b)<span>&nbsp;&nbsp;&nbsp;&nbsp;</span>回调函数：</span><strong><span>function</span></strong><span>(apiResult){}</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;apiResult.err_code : 错误码，0代表正常返会，其他代表发生错误。</span></p>
<p><span><span>&nbsp; &nbsp; &nbsp; &nbsp;</span>apiResult.err_msg : 错误详情，“ok”代表正常返回，其他代表具体的错误信息。</span></p>
<p><span><span>&nbsp; &nbsp; &nbsp; &nbsp;</span>apiResult.data : 是否关注，1代表已经关注，0代表未关注<span>。</span></span></p>
<p><span><strong>例子：</strong></span></p>
<div data-tag="backcolor">
<p><span></span></p>
<p><span><span>BeaconAddContactJsBridge.invoke(</span><span>'checkAddContactStatus'</span><span>,{type:0} ,</span></span></p>
<p><span><strong><span>function</span></strong><span>(apiResult){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span>if</span></strong><span>(apiResult.err_code == 0){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span>var</span></strong><span> status = apiResult.data;</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><strong><span>if</span></strong><span>(status == 1){</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(</span><span>'已关注'</span><span>);</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span>else</span></strong><span>{</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(</span><span>'未关注'</span><span>);&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></span></p>
<p><span><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span><strong><span>else</span></strong><span>{</span></span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; alert(apiResult.err_msg)</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; }</span></p>
<p><span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; });</span></p>
</div>
<p><span><strong>(二)跳转到关注页jumpAddContact</strong></span></p>
<p><span>a)</span><span>&nbsp;&nbsp;&nbsp;&nbsp; </span><span>参数：传入{type:0}表示关注设备归属的公众账号，传入{ type:1}表示关注门店归属的公众账号。不传默认为传入{type:0}。</span></p>
<p><span>b)</span><span>&nbsp;&nbsp;&nbsp;&nbsp; </span><span>回调函数：无<span>。</span></span></p>
<p><strong>例子：</strong>
<br></p>
<div data-tag="backcolor">
<p><span>BeaconAddContactJsBridge.invoke('jumpAddContact');
<br></span></p>
</div>
<p><span>
<br></span></p>
</div>
</div>
</div>
</div>
</body>
</html>