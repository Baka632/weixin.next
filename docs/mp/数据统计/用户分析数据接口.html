
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link onerror="wx_loaderror(this)" onerror="wx_loaderror(this)" rel="stylesheet" type="text/css" href="https://res.wx.qq.com/mpres/htmledition/style/page/resource/res_iframe2f613f.css"/></head>
<body class="page_doc">
<div class="main_hd"><h2>用户分析数据接口</h2>
</div>
<div class="main_bd">
<div class="article_box">
<div class="inner">
<div class="news_content">
<p><span></span>微信公众平台于2015年1月6日启动了数据接口的邀请内测。通过数据接口，开发者可以获取与公众平台官网统计模块类似但更灵活的数据，还可根据需要进行高级处理。</p>
<p>在公众号登录授权机制的权限集划分中，用户分析数据接口属于用户管理权限。</p>
<p>向所有公众号开发者开放数据接口的时间将另行通知。</p>
<p>请注意：</p>
<table class="table">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="963" valign="top"><p>1、接口侧的公众号数据的数据库中仅存储了2014年12月1日之后的数据，将查询不到在此之前的日期，即使有查到，也是不可信的脏数据；</p>
<p>2、请开发者在调用接口获取数据后，将数据保存在自身数据库中，即加快下次用户的访问速度，也降低了微信侧接口调用的不必要损耗。</p>
</td></tr>
</tbody>
</table>
<p>
<br></p>
<p>用户分析数据接口指的是用于获得公众平台官网数据统计模块中用户分析数据的接口，具体接口列表如下（暂无用户属性数据接口）：</p>
<table cellspacing="0" cellpadding="4" align="center" width="640px">
<tbody>
<tr class="firstRow thead"><th class="table_cell">接口名称</th><th class="table_cell">最大时间跨度</th><th class="table_cell">接口调用地址（必须使用https）</th></tr>
<tr><td class="table_cell">获取用户增减数据（getusersummary）</td><td class="table_cell">7</td><td class="table_cell"><a href="https://api.weixin.qq.com/datacube/getusersummary?access_token=ACCESS_TOKEN" class="external free" rel="nofollow" target="_blank">https://api.weixin.qq.com/datacube/getusersummary?access_token=ACCESS_TOKEN</a></td></tr>
<tr><td class="table_cell">获取累计用户数据（getusercumulate）</td><td class="table_cell">7</td><td class="table_cell"><a href="https://api.weixin.qq.com/datacube/getusercumulate?access_token=ACCESS_TOKEN" class="external free" rel="nofollow" target="_blank">https://api.weixin.qq.com/datacube/getusercumulate?access_token=ACCESS_TOKEN</a></td></tr>
</tbody>
</table>
<p>最大时间跨度是指一次接口调用时最大可获取数据的时间范围，如最大时间跨度为7是指最多一次性获取7天的数据。access_token的实际值请通过“获取access_token”来获取。</p>
<p>
<br><strong>接口调用请求说明</strong></p>
<p>用户分析数据接口（包括接口列表中的所有接口）需要向相应接口调用地址POST以下示例数据包：</p>
<pre>{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;"begin_date":&nbsp;"2014-12-02",&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;"end_date":&nbsp;"2014-12-07"
}</pre>
<p><strong>调用参数说明</strong></p>
<table cellspacing="0" cellpadding="4" align="center" width="640px">
<tbody>
<tr class="firstRow thead"><th class="table_cell">参数</th><th class="table_cell">是否必须</th><th class="table_cell">说明</th></tr>
<tr><td class="table_cell">access_token</td><td class="table_cell">是</td><td class="table_cell">调用接口凭证</td></tr>
<tr><td class="table_cell">begin_date</td><td class="table_cell">是</td><td class="table_cell">获取数据的起始日期，begin_date和end_date的差值需小于“最大时间跨度”（比如最大时间跨度为1时，begin_date和end_date的差值只能为0，才能小于1），否则会报错</td></tr>
<tr><td class="table_cell">end_date</td><td class="table_cell">是</td><td class="table_cell">获取数据的结束日期，end_date允许设置的最大值为昨日</td></tr>
</tbody>
</table>
<p><strong>返回说明</strong></p>
<p>正常情况下，获取用户增减数据接口的返回JSON数据包如下：</p>
<pre>{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;"list":&nbsp;[&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ref_date":&nbsp;"2014-12-07",&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"user_source":&nbsp;0,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"new_user":&nbsp;0,&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"cancel_user":&nbsp;0
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
	//后续还有ref_date在begin_date和end_date之间的数据
&nbsp;&nbsp;&nbsp;&nbsp;]
}</pre>
<p>正常情况下，获取累计用户数据接口的返回JSON数据包如下：</p>
<pre>{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;"list":&nbsp;[&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"ref_date":&nbsp;"2014-12-07",&nbsp;
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"cumulate_user":&nbsp;1217056
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;},&nbsp;
	//后续还有ref_date在begin_date和end_date之间的数据
&nbsp;&nbsp;&nbsp;&nbsp;]
}</pre>
<p><strong>返回参数说明</strong></p>
<table cellspacing="0" cellpadding="4" align="center" width="640px">
<tbody>
<tr class="firstRow thead"><th class="table_cell">参数</th><th class="table_cell">说明</th></tr>
<tr><td class="table_cell">ref_date</td><td class="table_cell">数据的日期</td></tr>
<tr><td class="table_cell">user_source</td><td class="table_cell">用户的渠道，数值代表的含义如下：<p>0代表其他合计 1代表公众号搜索 17代表名片分享 30代表扫描二维码 43代表图文页右上角菜单 51代表支付后关注（在支付完成页） 57代表图文页内公众号名称 75代表公众号文章广告 78代表朋友圈广告</p>
</td></tr>
<tr><td class="table_cell">new_user</td><td class="table_cell">新增的用户数量</td></tr>
<tr><td class="table_cell">cancel_user</td><td class="table_cell">取消关注的用户数量，new_user减去cancel_user即为净增用户数量</td></tr>
<tr><td class="table_cell">cumulate_user</td><td class="table_cell">总用户量</td></tr>
</tbody>
</table>
<p>错误时微信会返回错误码等信息，具体错误码查询，请见：<a href="http://mp.weixin.qq.com/wiki/10/6380dc743053a91c544ffd2b7c959166.html" class="external text" rel="nofollow">全局返回码说明</a></p>
<p>
<br></p>
</div>
</div>
</div>
</div>
</body>
</html>