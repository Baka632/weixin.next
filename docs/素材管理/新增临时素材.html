<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <link onerror="wx_loaderror(this)" onerror="wx_loaderror(this)" rel="stylesheet" type="text/css" href="https://res.wx.qq.com/mpres/htmledition/style/page/resource/res_iframe2f613f.css"/> 
</head>
<body class="page_doc">
    <div class="main_hd"><h2>新增临时素材</h2>
</div>
    <div class="main_bd"> 
        <div class="article_box">
            <div class="inner">
                <div class="news_content">
                    <p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"><span style="font-size: 14px; font-family: 微软雅黑, &quot;Microsoft YaHei&quot;;"></span>公众号经常有需要用到一些临时性的多媒体素材的场景，例如在使用接口特别是发送消息时，对多媒体文件、多媒体消息的获取和调用等操作，是通过media_id来进行的。素材管理接口对所有认证的订阅号和服务号开放。通过本接口，公众号可以新增临时素材（即上传临时多媒体文件）。</span><br></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"></span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">请注意：</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">1、对于临时素材，每个素材（media_id）会在开发者上传或粉丝发送到微信服务器3天后自动删除（所以用户发送给开发者的素材，若开发者需要，应尽快下载到本地），以节省服务器资源。</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">2、media_id是可复用的。</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">3、素材的格式大小等要求与公众平台官网一致。具体是，图片大小不超过2M，支持bmp/png/jpeg/jpg/gif格式，语音大小不超过5M，长度不超过60秒，支持mp3/wma/wav/amr格式</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">4、需使用https调用本接口。</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">本接口即为原“上传多媒体文件”接口。</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"><strong>接口调用请求说明</strong></span></p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);"><p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">http请求方式: POST/FORM,需使用https</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">https://api.weixin.qq.com/cgi-bin/media/upload?access_token=ACCESS_TOKEN&amp;type=TYPE</span></p>
<p style="line-height: normal;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">调用示例（使用curl命令，用FORM表单方式上传一个多媒体文件）：<br>curl -F media=@test.jpg "https://api.weixin.qq.com/cgi-bin/media/upload?access_token=ACCESS_TOKEN&amp;type=TYPE"<br></span></p>
</div><p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"><strong>参数说明</strong></span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"></span></p>
<table class="table" width="951"><tbody class="tbody"><tr class="firstRow thead"><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); font-weight: bold; line-height: 24.5px; text-align: center; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">参数</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); font-weight: bold; line-height: 24.5px; text-align: center; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">是否必须</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); font-weight: bold; line-height: 24.5px; text-align: center; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">说明</span></td></tr>
<tr><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">access_token</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">是</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">调用接口凭证</span></td></tr>
<tr><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">type</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">是<br></span></p>
</td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">媒体文件类型，分别有图片（image）、语音（voice）、视频（video）和缩略图（thumb）</span></td></tr>
<tr><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">media</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">是</span></td><td class="table_cell" width="217" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">form-data中媒体文件标识，有filename、filelength、content-type等信息</span></td></tr>
</tbody></table>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"><strong>返回说明</strong></span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">正确情况下的返回JSON数据包结果如下：</span></p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">{"type":"TYPE","media_id":"MEDIA_ID","created_at":123456789}</span></div>
<table class="table" width="951"><tbody class="tbody"><tr class="firstRow thead"><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); font-weight: bold; line-height: 24.5px; text-align: center; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">参数</span></td><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); font-weight: bold; line-height: 24.5px; text-align: center; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">描述</span></td></tr>
<tr><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">type</span></td><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">媒体文件类型，分别有图片（image）、语音（voice）、视频（video）和缩略图（thumb，主要用于视频与音乐格式的缩略图）</span></td></tr>
<tr><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">media_id</span></td><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">媒体文件上传后，获取时的唯一标识</span></td></tr>
<tr><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">created_at</span></td><td class="table_cell" width="325" valign="top" style="word-break: break-all;"><span style="color: rgb(51, 51, 51); line-height: 24.5px; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px; background-color: rgb(255, 255, 255);">媒体文件上传时间戳</span></td></tr>
</tbody></table>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">错误情况下的返回JSON数据包示例如下（示例为无效媒体类型错误）：</span></p>
<div data-tag="backcolor" style="margin-bottom: 14px; padding: 10px 16px; background-color: rgb(253, 234, 218);"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">{"errcode":40004,"errmsg":"invalid media type"}</span></div>
<p><strong style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">注意事项</strong><br></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">上传的临时多媒体文件有格式和大小限制，如下：</span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">&nbsp; &nbsp; 图片（image）: 2M，支持JPG格式</span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">&nbsp; &nbsp; 语音（voice）：2M，播放长度不超过60s，支持AMR\MP3格式</span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">&nbsp; &nbsp; 视频（video）：10MB，支持MP4格式</span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">&nbsp; &nbsp; 缩略图（thumb）：64KB，支持JPG格式</span></p>
<p><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"><strong>媒体文件在后台保存时间为3天，即3天后media_id失效。</strong></span></p>
<p><a href="https://mp.weixin.qq.com/debug/cgi-bin/apiinfo?t=index&amp;type=%E5%9F%BA%E7%A1%80%E6%94%AF%E6%8C%81&amp;form=%E5%A4%9A%E5%AA%92%E4%BD%93%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%8E%A5%E5%8F%A3%20/media/upload" target="_blank" style="text-decoration: underline; font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;"><span style="font-family: 微软雅黑, 'Microsoft YaHei'; font-size: 14px;">使用网页调试工具调试该接口</span></a></p>
                </div>
            </div>
        </div>
    </div>
</body>
</html>