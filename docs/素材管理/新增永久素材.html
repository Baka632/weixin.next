
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<link onerror="wx_loaderror(this)" onerror="wx_loaderror(this)" rel="stylesheet" type="text/css" href="https://res.wx.qq.com/mpres/htmledition/style/page/resource/res_iframe2f613f.css"/></head>
<body class="page_doc">
<div class="main_hd"><h2>新增永久素材</h2>
</div>
<div class="main_bd">
<div class="article_box">
<div class="inner">
<div class="news_content">
<p><span></span>除了3天就会失效的临时素材外，开发者有时需要永久保存一些素材，届时就可以通过本接口新增永久素材。</p>
<p><strong>最近更新，永久图片素材新增后，将带有URL返回给开发者，开发者可以在腾讯系域名内使用（腾讯系域名外使用，图片将被屏蔽）。</strong></p>
<p>请注意：</p>
<p>1、新增的永久素材也可以在公众平台官网素材管理模块中看到</p>
<p>2、永久素材的数量是有上限的，请谨慎新增。图文消息素材和图片素材的上限为5000，其他类型为1000</p>
<p>3、素材的格式大小等要求与公众平台官网一致。具体是，图片大小不超过2M，支持bmp/png/jpeg/jpg/gif格式，语音大小不超过5M，长度不超过60秒，支持mp3/wma/wav/amr格式</p>
<p>4、调用该接口需https协议</p>
<p><span><strong>新增永久图文素材</strong></span></p>
<p><strong>接口调用请求说明</strong></p>
<div data-tag="backcolor"><p>http请求方式: POST</p>
<p>https://api.weixin.qq.com/cgi-bin/material/add_news?access_token=ACCESS_TOKEN</p>
</div>
<p><strong>调用示例</strong></p>
<div data-tag="backcolor"><p>{</p>
<p>&nbsp; "articles": [{</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"title": TITLE,</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"thumb_media_id": THUMB_MEDIA_ID,</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"author": AUTHOR,</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"digest": DIGEST,</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"show_cover_pic": SHOW_COVER_PIC(0 / 1),</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"content": CONTENT,</p>
<p>&nbsp; &nbsp; &nbsp; &nbsp;"content_source_url": CONTENT_SOURCE_URL</p>
<p>&nbsp; &nbsp; },</p>
<p>&nbsp; &nbsp; //若新增的是多图文素材，则此处应还有几段articles结构</p>
<p>&nbsp;]</p>
<p>}</p>
</div>
<p><strong>参数说明</strong></p>
<table class="table" width="951">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="217" valign="top">参数</td><td class="table_cell" width="217" valign="top">是否必须</td><td class="table_cell" width="217" valign="top">说明</td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>title</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>标题</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>thumb_media_id</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>图文消息的封面图片素材id（必须是永久mediaID）</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>author</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>作者</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>digest</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>图文消息的摘要，仅有单图文消息才有摘要，多图文此处为空</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>show_cover_pic</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>是否显示封面，0为false，即不显示，1为true，即显示</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>content</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>图文消息的具体内容，支持HTML标签，必须少于2万字符，小于1M，且此处会去除JS</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>content_source_url</span></td><td class="table_cell" width="217" valign="top">是</td><td class="table_cell" width="217" valign="top"><span>图文消息的原文地址，即点击“阅读原文”后的URL</span></td></tr>
</tbody>
</table>
<p><strong>返回说明</strong></p>
<div data-tag="backcolor">{<br> &nbsp; "media_id":MEDIA_ID<br>}</div>
<p>返回的即为新增的图文消息素材的media_id。</p>
<p>请注意，在图文消息的具体内容中，将过滤外部的图片链接，开发者可以通过下述接口上传图片得到URL，放到图文内容中使用。</p>
<p><strong>上传图文消息内的图片获取URL</strong> 请注意，本接口所上传的图片不占用公众号的素材库中图片数量的5000个的限制。图片仅支持jpg/png格式，大小必须在1MB以下。</p>
<p><strong>接口调用请求说明</strong></p>
<div data-tag="backcolor"><p>http请求方式: POST</p>
<p>https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=ACCESS_TOKEN</p>
<p>调用示例（使用curl命令，用FORM表单方式上传一个图片）：</p>
<p>curl -F media=@test.jpg "https://api.weixin.qq.com/cgi-bin/media/uploadimg?access_token=ACCESS_TOKEN"</p>
</div>
<p><strong>参数说明</strong></p>
<table class="table" width="951">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="217" valign="top">参数</td><td class="table_cell" width="217" valign="top">是否必须</td><td class="table_cell" width="217" valign="top">说明</td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>access_token</span></td><td class="table_cell" width="217" valign="top"><span>是</span></td><td class="table_cell" width="217" valign="top"><span>调用接口凭证</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>media</span></td><td class="table_cell" width="217" valign="top"><span>是</span></td><td class="table_cell" width="217" valign="top"><span>form-data中媒体文件标识，有filename、filelength、content-type等信息</span></td></tr>
</tbody>
</table>
<p><strong>返回说明</strong> 正常情况下的返回结果为：</p>
<div data-tag="backcolor"><p>{</p>
<p>&nbsp; &nbsp; "url": &nbsp;"http://mmbiz.qpic.cn/mmbiz/gLO17UPS6FS2xsypf378iaNhWacZ1G1UplZYWEYfwvuU6Ont96b1roYs CNFwaRrSaKTPCUdBK9DgEHicsKwWCBRQ/0"</p>
<p>}</p>
</div>
<p>其中url就是上传图片的URL，可用于后续群发中，放置到图文消息中。</p>
<p><strong>新增其他类型永久素材</strong></p>
<p><strong>接口调用请求说明</strong></p>
<p>通过POST表单来调用接口，表单id为media，包含需要上传的素材内容，有filename、filelength、content-type等信息。请注意：图片素材将进入公众平台官网素材管理模块中的默认分组。</p>
<div data-tag="backcolor"><p>http请求方式: POST，需使用https</p>
<p>https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=ACCESS_TOKEN&amp;type=TYPE</p>
<p>调用示例（使用curl命令，用FORM表单方式新增一个其他类型的永久素材，curl命令的使用请自行查阅资料）</p>
</div>
<p><strong><strong>参数说明</strong></strong></p>
<table class="table" width="951">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="217" valign="top"><span>参数</span></td><td class="table_cell" width="217" valign="top"><span>是否必须</span></td><td class="table_cell" width="217" valign="top"><span>说明</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>access_token</span></td><td class="table_cell" width="217" valign="top"><span>是</span></td><td class="table_cell" width="217" valign="top"><span>调用接口凭证</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>type</span></td><td class="table_cell" width="217" valign="top"><span>是</span></td><td class="table_cell" width="217" valign="top"><span>媒体文件类型，分别有图片（image）、语音（voice）、视频（video）和缩略图（thumb）</span></td></tr>
<tr><td class="table_cell" width="217" valign="top"><span>media</span></td><td class="table_cell" width="217" valign="top"><span>是</span></td><td class="table_cell" width="217" valign="top"><span>form-data中媒体文件标识，有filename、filelength、content-type等信息</span></td></tr>
</tbody>
</table>
<p>新增永久视频素材需特别注意</p>
<p>在上传视频素材时需要POST另一个表单，id为description，包含素材的描述信息，内容格式为JSON，格式如下：</p>
<div data-tag="backcolor">{<br> &nbsp;"title":VIDEO_TITLE,<br> &nbsp;"introduction":INTRODUCTION<br>}</div>
<p>新增永久视频素材的调用示例：</p>
<div data-tag="backcolor">curl "https://api.weixin.qq.com/cgi-bin/material/add_material?access_token=ACCESS_TOKEN<span>&amp;type=TYPE</span>" -F media=@media.file -F &nbsp;description='{"title":VIDEO_TITLE, "introduction":INTRODUCTION}'</div>
<p>参数说明</p>
<table class="table">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="301" valign="top">参数</td><td class="table_cell" width="301" valign="top">是否必须</td><td class="table_cell" width="301" valign="top">说明</td></tr>
<tr><td class="table_cell" width="301" valign="top">title</td><td class="table_cell" width="301" valign="top">是</td><td class="table_cell" width="301" valign="top">视频素材的标题</td></tr>
<tr><td class="table_cell" width="301" valign="top">introduction</td><td class="table_cell" width="301" valign="top">是</td><td class="table_cell" width="301" valign="top">视频素材的描述</td></tr>
</tbody>
</table>
<p>返回说明</p>
<div data-tag="backcolor">{<br> &nbsp;"media_id":MEDIA_ID,<br> &nbsp;"url":URL<br>}</div>
<p>返回参数说明</p>
<table class="table">
<tbody class="tbody">
<tr class="firstRow thead"><td class="table_cell" width="462" valign="top">参数</td><td class="table_cell" width="462" valign="top">描述</td></tr>
<tr><td class="table_cell" width="462" valign="top">media_id</td><td class="table_cell" width="462" valign="top">新增的永久素材的media_id</td></tr>
<tr><td class="table_cell" width="462" valign="top">url</td><td class="table_cell" width="462" valign="top">新增的图片素材的图片URL（仅新增图片素材时会返回该字段）</td></tr>
</tbody>
</table>
<p>错误情况下的返回JSON数据包示例如下（示例为无效媒体类型错误）：</p>
<div data-tag="backcolor">{"errcode":40007,"errmsg":"invalid media_id"}</div>
<p>
<br></p>
<p><strong>
<br></strong></p>
<p><span></span>
<br></p>
</div>
</div>
</div>
</div>
</body>
</html>